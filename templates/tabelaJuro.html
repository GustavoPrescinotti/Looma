{% extends 'templateDashboard.html' %}

{% block conteudo %}
<div class="container">
    {% include 'components/sidebar.html' %}
    <div class="main-content">
        <div class="content-wrapper">
            <h1 class="main-title">Visão Geral:</h1>

            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    <div class="flash-messages-container">
                        {% for category, message in messages %}
                        <div class="flash-message flash-{{ category }}">
                            <span class="flash-icon">
                                {% if category == 'success' %}✓{% elif category == 'error' %}✕{% else %}ℹ{% endif %}
                            </span>
                            <span class="flash-text">{{ message }}</span>
                            <button class="flash-close" onclick="this.parentElement.style.display='none'">&times;</button>
                        </div>
                        {% endfor %}
                    </div>
                {% endif %}
            {% endwith %}

            <div class="table-container">
                <div class="table">
                    <div class="table-row table-header">
                        <div class="table-cell">Ano</div>
                        <div class="table-cell">Taxa Mensal</div>
                        <div class="table-cell">Data Criação</div>
                        <div class="table-cell">Quem Modificou?</div>
                        {% if session['usuario'][4] == 'admin' %}
                        <div class="table-cell">Ações</div>
                        {% endif %}
                    </div>
                    {% for taxa in taxas %}
                    <div class="table-row">
                        <div class="table-cell">{{taxa[1]}}</div>
                        <div class="table-cell">{{taxa[2]}}%</div>
                        <div class="table-cell">{{taxa[3]}}</div>
                        <div class="table-cell">{{taxa[4]}}</div>
                        {% if session['usuario'][4] == 'admin' %}
                        <div class="table-cell actions">
                            <a href="{{url_for('editar_taxa', id=taxa[0])}}" class="btn-edit">Editar</a>
                            <a href="{{url_for('excluir_taxa', id=taxa[0])}}" class="btn-delete">Excluir</a>
                        </div>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>
            </div>

            <div class="cards-container">
                {% for taxa in taxas %}
                <div class="card card-juros">
                    <div class="card-row">
                        <span class="card-label">Ano:</span>
                        <span class="card-value">{{ taxa[1] }}</span>
                    </div>
                    <div class="card-row">
                        <span class="card-label">Taxa Mensal:</span>
                        <span class="card-value">{{ taxa[2] }}%</span>
                    </div>
                    <div class="card-row">
                        <span class="card-label">Data Criação:</span>
                        <span class="card-value">{{ taxa[3] }}</span>
                    </div>
                    <div class="card-row">
                        <span class="card-label">Quem Modificou:</span>
                        <span class="card-value">{{ taxa[4] }}</span>
                    </div>
                    {% if session['usuario'][4] == 'admin' %}
                    <div class="card-actions">
                        <a href="{{url_for('editar_taxa', id=taxa[0])}}" class="btn-edit">Editar</a>
                        <a href="{{url_for('excluir_taxa', id=taxa[0])}}" class="btn-delete">Excluir</a>
                    </div>
                    {% endif %}
                </div>
                {% else %}
                <div class="card">
                    <p style="text-align: center; padding: 20px; color: #666;">Nenhuma taxa cadastrada.</p>
                </div>
                {% endfor %}
            </div>

        </div>
    </div>
</div>
{% endblock %}