{% extends 'templateDashboard.html' %}

{% block conteudo %}
<div class="container">
    {% include 'components/sidebar.html' %}
    <main class="main">
        <section class="card">
            <h2 class="card-title">Simulação de Empréstimo</h2>
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    <div class="flash-messages">
                        {% for category, message in messages %}
                        <div class="flash-message flash-{{ category }}">{{ message }}</div>
                        {% endfor %}
                    </div>
                {% endif %}
            {% endwith %}

            <form class="form" action="{{ url_for('nova_simulacao') }}" method="post" novalidate>
                <div class="field">
                    <label class="label" for="valor">Valor Desejado:</label>
                    <input id="valor" name="valor" type="number" class="input" placeholder="Digite o valor desejado" />
                    <!-- <input id="valor" name="valor" type="text" class="input" placeholder="Digite o valor desejado"
                           value="{{ request.form.valor or '' }}" required pattern="^\d+(\.\d{1,2})?$"
                           title="Digite um valor numérico válido (ex: 5000.00)" /> -->
                </div>

                <div class="field">
                    <label class="label label--center" for="ano">Ano do Empréstimo:</label>
                    <input id="ano" name="ano" type="number" class="input" placeholder="Digite o ano"
                            value="{{ current_year }}" readonly />
                </div>

                <div class="field">
                    <label class="label" for="adm">Administrador da Taxa Anual:</label>
                    <select id="adm" name="adm" class="input" required>
                        <option value="" disabled selected>Selecione o administrador</option>
                        {% for admin in admins %}
                            <option value="{{ admin.nome }}" {% if request.form.adm==admin.nome %}selected{% endif %}>{{ admin.nome }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="field">
                    <label class="label" for="data_criacao">Data de Criação do Empréstimo:</label>
                    <input id="data_criacao" name="data_criacao" type="date" class="input" value="{{ current_date }}" readonly />
                </div>

                <div class="field">
                    <label class="label" for="prazo">Prazo (Meses):</label>
                    <input id="prazo" name="prazo" type="text" class="input" placeholder="Digite o prazo em meses"
                        oninput="this.value = this.value.replace(/[^0-9]/g, '')" />
                </div>

                <div class="actions-row">
                    <button type="submit" class="btn btn--primary">Simular</button>
                    <a href="{{request.referrer or url_for('dashboard')}}" class="btn btn--outline">Cancelar</a>
                </div>
            </form>
        </section>
    </main>
</div>
{% endblock %}
