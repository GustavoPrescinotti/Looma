{% extends 'templateDashboard.html' %}

{% block conteudo %}
<div class="container">
    {% include 'components/sidebar.html' %}
    <div class="main-content">
        <div class="flash-messages-container">
            {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
            {% for category, message in messages %}
            <div class="flash-message flash-{{ category }}">
                <span class="flash-text">{{ message }}</span>
                <button class="flash-close" onclick="this.parentElement.style.display='none'">&times;</button>
            </div>
            {% endfor %}
            {% endif %}
            {% endwith %}
        </div>

        <section>
            <h3 class="section-title">Seu Resumo Financeiro</h3>
            <div class="cards cards--summary">
                <article class="card card--blue">
                    <h4 class="card__title">Receitas Totais</h4>
                    <p class="card__value card__value--xl">R$ {{ "%.2f"|format(total_receitas) }}</p>
                </article>
                <article class="card card--dark">
                    <h4 class="card__title card__title--light">Despesas Totais</h4>
                    <p class="card__value card__value--xl card__value--light">R$ {{ "%.2f"|format(total_despesas) }}</p>
                </article>
                <article class="card card--white">
                    <h4 class="card__title">Renda Líquida</h4>
                    <p class="card__value card__value--xl {% if renda_liquida < 0 %}card__value--negative{% endif %}">
                        R$ {{ "%.2f"|format(renda_liquida) }}
                    </p>
                </article>
                <article class="card card--white">
                    <h4 class="card__title">Limite de Empréstimo</h4>
                    <p class="card__value card__value--xl">R$ {{ "%.2f"|format(limite_emprestimo) }}</p>
                </article>
            </div>
        </section>

        <section>
            <h3 class="section-title section-title--sm text-center">Seus Empréstimos</h3>
            {% if emprestimos.lista_emprestimos %}
                {% for emprestimo in emprestimos.lista_emprestimos %}
                <div class="cards cards--loans">
                    <article class="card card--white">
                        <h4 class="card__title">Valor Total</h4>
                        <p class="card__value card__value--lg">R$ {{ '%.2f'|format(emprestimo.total_a_pagar) }}</p>
                    </article>
                    <article class="card card--white">
                        <h4 class="card__title">Parcelas<br />Restantes</h4>
                        <p class="card__value card__value--lg">{{ emprestimo.parcelas_restantes }}</p>
                    </article>
                    <article class="card card--white">
                        <h4 class="card__title">Próximo<br />Vencimento</h4>
                        <p class="card__value card__value--lg">
                            {% if emprestimo.proximo_vencimento %}
                                {{ emprestimo.proximo_vencimento }}
                            {% else %}
                                Não Definido
                            {% endif %}
                        </p>
                    </article>
                </div>
                {% endfor %}
            {% else %}
            <p>Você não possui empréstimos no momento.</p>
            {% endif %}
        </section>
    </div>
</div>
<style>
    .text-center {
        text-align: center;
    }
</style>
{% endblock %}